<nb-card>
	<ng-template #modalContent let-close="close">
		<div class="modal-header">
			<h5 class="modal-title">{{ modalData.event.title }}
				<ng-container *ngIf="authService.isAuthenticated()">
					<button *ngIf="!eventsService.isSignedUp(modalData.event.meta); else Pending"
					type="button" class="btn
					btn-outline-primary"(click)="userPending(); close();">Sign Up</button>
				</ng-container>

				<ng-template #Pending>
					<button type="button" 
					class="btn btn-outline-primary"
					(click)="unregister(); close();">Pending</button>
				</ng-template>
			</h5>

				<button type="button" class="close" (click)="close()">
					<span aria-hidden="true">&times;</span>
				</button>
		</div>

		<div class="modal-body">
			<nb-card>
				<nb-card-body>
					<!--- ALL THE FIELDS WOULD GO HERE IN SOME SORT OF STYLED ORDER-->
		 <!--- ACCESS THE DAT USEING {{ modalData.event.meta.FIELDNAME}}-->
		 			<div>
						Start Date <pre>{{ modalData.event.meta.date[0] }}</pre>
					</div>

					<div>
						End Date <pre>{{ modalData.event.meta.date[1] }}</pre>
          </div>

					<div> Assigned OIC
						<mat-list>
							<pre>
								<mat-list-item *ngFor="let user of modalData.event.meta.OIC">
									<nb-user [name]="user.lastName + ',' + user.firstName" 
											[title]="user.rank">
									</nb-user>
								</mat-list-item>
							</pre>
						</mat-list>
					</div>

					<div>Signed Up 
						<ng-container *ngIf="modalData.event.meta.isSignupRequired &&
											modalData.event.meta.signedUp.length> 0; 
											else NoUsersSignedUp">
							<mat-list>
								<pre>
									<mat-list-item *ngFor="let user of modalData.event.meta.signedUp">
										<nb-user [name]="user.lastName + ',' + user.firstName"
												[title]="user.rank">
										</nb-user>
									</mat-list-item>
								</pre>
							</mat-list>
						</ng-container>
						
						<ng-template #NoUsersSignedUp>
							<pre> No Users Signed Up</pre>
						</ng-template>
					</div>

					<div *ngIf="eventsService.isOIC(modalData.event.meta) || 
					authService.isAdmin()"> Pending
						<mat-list>
							<pre>
								<mat-list-item *ngFor="let user of modalData.event.meta.pending">
									<nb-user [name]="user.lastName + ',' + user.firstName"
										[title]="user.rank">
									</nb-user>
								</mat-list-item>
							</pre>
						</mat-list>
					</div>

					<ng-container *ngIf="modalData.event.meta.additionalDetails.length > 0">
						<div *ngFor="let detail of modalData.event.meta.additionalDetails">
							{{ detail?.title }}
							<pre>{{ detail?.details}}</pre>
						</div>
					</ng-container>
				</nb-card-body>
			</nb-card>
		</div> 

		<div class="modal-footer">
      <button *ngIf="eventsService.isOIC(modalData.event.meta) || authService.isAdmin()"
        type="button" class="btn
				btn-outline-primary"(click)="close(); openUpdateDialog();">Edit</button>
			<button type="button" class="btn btn-outline-primary"(click)="close()">OK</button>
		</div>
	</ng-template>


	<div class="row text-center">
		<div class="col-md-4">
			<div class="btn-group">
				<div
					class="btn btn-primary"
					mwlCalendarPreviousView
					[view]="view"
					[(viewDate)]="viewDate"
					(viewDateChange)="activeDayIsOpen = false">
				Previous
      			</div>
      
				<div
					class="btn btn-outline-secondary"
					mwlCalendarToday
					[(viewDate)]="viewDate">
				Today
				</div>

      <div
        class="btn btn-primary"
        mwlCalendarNextView
        [view]="view"
        [(viewDate)]="viewDate"
        (viewDateChange)="activeDayIsOpen = false">
        Next
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <h3>{{ viewDate | calendarDate:(view + 'ViewTitle'):'en' }}</h3>
  </div>
  <div class="col-md-4">
    <div class="btn-group">
      <div
        class="btn btn-primary"
        (click)="view = 'month'"
        [class.active]="view === 'month'">
        Month
      </div>
      <div
        class="btn btn-primary"
        (click)="view = 'week'"
        [class.active]="view === 'week'">
        Week
      </div>
      <div
        class="btn btn-primary"
        (click)="view = 'day'"
        [class.active]="view === 'day'">
        Day
      </div>
    </div>
  </div>
</div>
<br>
<div [ngSwitch]="view">
  <mwl-calendar-month-view
    *ngSwitchCase="'month'"
    [viewDate]="viewDate"
    [events]="events"
    [refresh]="refresh"
    [activeDayIsOpen]="activeDayIsOpen"
    (dayClicked)="dayClicked($event.day)"
    (eventClicked)="handleEvent('Clicked', $event.event)"
    (eventTimesChanged)="eventTimesChanged($event)">
  </mwl-calendar-month-view>
  <mwl-calendar-week-view
    *ngSwitchCase="'week'"
    [viewDate]="viewDate"
    [events]="events"
    [refresh]="refresh"
    (eventClicked)="handleEvent('Clicked', $event.event)"
    (eventTimesChanged)="eventTimesChanged($event)">
  </mwl-calendar-week-view>
  <mwl-calendar-day-view
    *ngSwitchCase="'day'"
    [viewDate]="viewDate"
    [events]="events"
    [refresh]="refresh"
    (eventClicked)="handleEvent('Clicked', $event.event)"
    (eventTimesChanged)="eventTimesChanged($event)">
  </mwl-calendar-day-view>
</div>
<button mat-fab 
	color="primary"
	(click)="openCreateDialog()">
	<mat-icon class="ion-plus-round">
	</mat-icon>
</button>
</nb-card>
