import { Injectable                                 } from '@angular/core';
import { Router, CanActivate, RouterStateSnapshot   } from '@angular/router';
import { ActivatedRouteSnapshot                     } from '@angular/router';
import { Observable                                 } from 'rxjs/Rx';
import { LogService                                 } from './logs.service';
import { AuthService                                } from './auth.service';
import 'rxjs/add/operator/map';

@Injectable()
export class WaitForApiLoad implements CanActivate {
    private user        : Object;

    constructor(private authService: AuthService) {}
    canActivate(activatedRouteSnapshot: ActivatedRouteSnapshot, 
            routerStateSnapshot: RouterStateSnapshot)  
    {
        this.authService.getProfile().subscribe(profile => {
            this.user = profile.user;
            return true;
        });
        //return true;
    }

    getUser() { return this.user; }
}

